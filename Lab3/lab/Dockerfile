FROM php:8.0-apache

RUN apt-get update 

RUN docker-php-ext-install mysqli && docker-php-ext-enable mysqli

WORKDIR /var/www/html/

COPY ./src .

# Copy a custom Apache configuration file to the container
COPY ./src/configs/docker-php.conf /etc/apache2/conf-available/docker-php.conf

# Set ownership of the application directory
RUN chown -R root:www-data /var/www/html

# set appopriate permissions for the files and directories
RUN chmod 750 /var/www/html
RUN find . -type f -exec chmod 640 {} \;
RUN find . -type d -exec chmod 750 {} \;

# Add write permissions for the group to /admin/note
RUN chmod g+w /var/www/html/admin/note

# Add a flag to the /etc/passwd file 
RUN echo "Bounty_boys{2nd_flag}" >> /etc/passwd
